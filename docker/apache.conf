<VirtualHost *:80>
    ServerName worlds.local
    DocumentRoot /var/www/html/public

    <Directory /var/www/html/public>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        # Enable clean URLs via mod_rewrite
        RewriteEngine On

        # Redirect all requests to index.php except existing files/directories
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^ index.php [L]
    </Directory>

    # Deny access to sensitive directories
    <DirectoryMatch "^/var/www/html/(data|database|src|tests|documentation)">
        Require all denied
    </DirectoryMatch>

    # Security headers
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"

    ErrorLog ${APACHE_LOG_DIR}/worlds-error.log
    CustomLog ${APACHE_LOG_DIR}/worlds-access.log combined
</VirtualHost>
